# LAMMPS Quenching Script for Ba5Li2WO53 - 50 K/ps
# SLOW quench - mixed amorphous/crystalline
units metal
atom_style charge
boundary p p p
processors * * *  # Use all available processors

# MUST define potential BEFORE reading data file that contains pair coeffs!
# Define potential first
# Morse potential for strong ceramic bonding
# This gives REAL solid behavior, not gas!

# Morse potential - much better for solids than LJ
pair_style morse 12.0
# pair_coeff i j D0 alpha r0
# D0=5.0 eV (VERY strong bonds - ceramics need this!)
# alpha=2.0 (steepness)  
# r0=2.5 Angstrom (equilibrium bond distance)
pair_coeff * * 5.0 2.0 2.5

# This will give:
# - Strong attraction at ~2.5 Angstrom (solid density)
# - Strong repulsion below 2.0 Angstrom (atoms don't overlap)
# - Negligible interaction beyond 5-6 Angstrom

# Alternative: Use a tabulated potential from DFT if available
# pair_style table linear 1000
# pair_coeff * * potential.table ENTRY

# Neighbor list
neighbor 2.0 bin
neigh_modify every 1 delay 0 check yes

# NOW read melted/liquid structure (after pair_style is defined)
read_data Ba5Li2WO53_melted_liquid.data

# STAGE 1: QUENCH from 5000K to 300K at 50 K/ps
# This will take 94.0 ps
# Use NVT to maintain density during cooling
fix 1 all nvt temp 5000 300 $(100.0*dt)
timestep 0.001

# Output
thermo 1000
thermo_style custom step time temp press vol etotal ke pe density
dump 1 all custom 5000 Ba5Li2WO53_quench_50Kps_trajectory.dump id type x y z vx vy vz

print "Starting QUENCH of Ba5Li2WO53 from liquid at 5000K to 300K"
print "Cooling rate: 50 K/ps - expecting mixed_crystalline"
run 94000

# STAGE 2: Equilibrate at 300K for 50 ps
unfix 1
fix 1 all nvt temp 300 300 $(100.0*dt)

print "Equilibrating Ba5Li2WO53 quenched structure at 300K"
run 50000

# STAGE 3: Final minimization
minimize 1.0e-4 1.0e-6 1000 10000

# Save quenched structure with descriptive name
write_data Ba5Li2WO53_quenched_50Kps_mixed_crystalline.data
write_dump all xyz Ba5Li2WO53_quenched_50Kps_mixed_crystalline.xyz modify element O Li W Ba
undump 1

print "QUENCH COMPLETE for {formula} at {cooling_rate} K/ps - structure type: {structure_type}"
