# LAMMPS Crystal Melting Script for Li2Fe3SbO8
# Takes ordered crystal structure and melts it at high temperature
units metal
atom_style charge
boundary p p p
processors * * *  # Use all available processors

# Read CRYSTAL structure from Materials Project
read_data Li2Fe3SbO8_crystal.data

# Define potential
# Morse potential for strong ceramic bonding
# This gives REAL solid behavior, not gas!

# Morse potential - much better for solids than LJ
pair_style morse 12.0

# Set pair coefficients for Morse potential
# D0=5.0 eV (strong bonds), alpha=2.0, r0=2.5 Angstrom  
pair_coeff * * 5.0 2.0 2.5

# Neighbor list
neighbor 2.0 bin
neigh_modify every 1 delay 0 check yes

# Initial minimization of crystal
minimize 1.0e-4 1.0e-6 1000 10000

# Initial velocities
velocity all create 300 12345 dist gaussian mom yes rot yes

# STAGE 1: Heat crystal from 300K to 4500K over 100 ps
# Use NVT instead of NPT to prevent excessive expansion
fix 1 all nvt temp 300 4500 $(100.0*dt)
timestep 0.001

# Output
thermo 1000
thermo_style custom step time temp press vol etotal ke pe density
dump 1 all custom 5000 Li2Fe3SbO8_melting_trajectory.dump id type x y z vx vy vz

print "Starting MELTING of Li2Fe3SbO8: heating crystal from 300K to 4500K"
run 100000

# STAGE 2: Hold at 4500K for 50 ps to ensure fully melted
unfix 1
fix 1 all nvt temp 4500 4500 $(100.0*dt)

print "Equilibrating Li2Fe3SbO8 MELT at 4500K for 50 ps"
run 50000

# Save melted/liquid structure
write_data Li2Fe3SbO8_melted_liquid.data nocoeff
write_dump all xyz Li2Fe3SbO8_melted_liquid.xyz modify element Li Fe Sb O
undump 1

print "MELTING COMPLETE for {formula} - crystal is now liquid at $(temp)K"
